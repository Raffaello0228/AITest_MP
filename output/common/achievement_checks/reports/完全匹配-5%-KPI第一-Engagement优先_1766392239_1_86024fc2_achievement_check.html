<!DOCTYPE html>
<html lang='zh-CN'>
<head>
  <meta charset='UTF-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>测试报告 - 完全匹配-5%-KPI第一-Engagement优先</title>
  <style>
    body { font-family: 'Microsoft YaHei', Arial, sans-serif; margin: 20px; background: #f5f5f5; }
    .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    h1 { color: #333; border-bottom: 3px solid #4CAF50; padding-bottom: 10px; }
    h2 { color: #555; margin-top: 30px; border-left: 4px solid #4CAF50; padding-left: 10px; }
    table { width: 100%; border-collapse: collapse; margin: 20px 0; }
    th, td { padding: 12px; text-align: left; border: 1px solid #ddd; }
    th { background-color: #4CAF50; color: white; font-weight: bold; }
    tr:nth-child(even) { background-color: #f9f9f9; }
    .status-ok { color: #4CAF50; font-weight: bold; }
    .status-fail { color: #f44336; font-weight: bold; }
    .summary { background: #e8f5e9; padding: 15px; border-radius: 5px; margin: 20px 0; }
    .config-table { background: #fff3e0; }
  </style>
</head>
<body>
  <div class='container'>
    <h1>测试报告</h1>
    <p><strong>测试用例</strong>: 完全匹配-5%-KPI第一-Engagement优先</p>
    <p><strong>UUID</strong>: 40a2943a-9d94-49f8-927d-3189ec95</p>
    <p><strong>Job ID</strong>: 1766392239_1_86024fc2</p>
    <p><strong>生成时间</strong>: 2025-12-31 18:34:28</p>
    <h2>测试配置</h2>
    <table class='config-table'>
      <tr><th>配置项</th><th>值</th></tr>
      <tr><td>KPI目标达成率</td><td>80%</td></tr>
      <tr><td>区域预算目标达成率</td><td>90%</td></tr>
      <tr><td>区域KPI目标达成率</td><td>80%</td></tr>
      <tr><td>广告类型KPI目标达成率</td><td>80%</td></tr>
      <tr><td>阶段预算误差范围</td><td>20%</td></tr>
      <tr><td>营销漏斗预算误差范围</td><td>15%</td></tr>
      <tr><td>媒体预算误差范围</td><td>5%</td></tr>
    </table>
    <h3>KPI优先级</h3>
    <table class='config-table'>
      <tr><th>优先级</th><th>KPI</th></tr>
      <tr><td>1</td><td>Engagement</td></tr>
      <tr><td>2</td><td>VideoViews</td></tr>
      <tr><td>3</td><td>Impression</td></tr>
    </table>
    <h3>模块优先级</h3>
    <table class='config-table'>
      <tr><th>优先级</th><th>模块</th></tr>
      <tr><td>1</td><td>kpiInfo</td></tr>
      <tr><td>2</td><td>regionBudget</td></tr>
      <tr><td>3</td><td>media</td></tr>
      <tr><td>4</td><td>marketingFunnel</td></tr>
      <tr><td>5</td><td>stage</td></tr>
      <tr><td>6</td><td>regionKPI</td></tr>
      <tr><td>7</td><td>mediaMarketingFunnelAdtype</td></tr>
    </table>
    <h2>全局 KPI 达成情况</h2>
    <div class='summary'><strong>达成率</strong>: 3/3 (100.0%)</div>
    <div class='summary'><strong>判断逻辑</strong>: 当"必须达成"为"是"时，要求实际值 ≥ 目标值；当"必须达成"为"否"时，满足达成率条件即可。</div>
    <table>
      <tr><th>KPI</th><th>优先级</th><th>必须达成</th><th>实际值</th><th>目标值</th><th>达成率</th><th>状态</th></tr>
      <tr><td>Engagement</td><td>1</td><td>否</td><td>428,695,549</td><td>264,644,640</td><td>162.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>VideoViews</td><td>2</td><td>否</td><td>1,404,774,797</td><td>869,046,442</td><td>162.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>Impression</td><td>3</td><td>是</td><td>3,675,695,538</td><td>3,118,609,566</td><td>118.00%</td><td class='status-ok'>✓ 达成</td></tr>
    </table>
    <h2>区域预算达成情况</h2>
    <div class='summary'><strong>匹配类型</strong>: 完全匹配 | <strong>达成率</strong>: 10/10 (100.0%)</div>
    <table>
      <tr><th>区域</th><th>实际占比</th><th>目标占比</th><th>误差</th><th>允许误差</th><th>状态</th></tr>
      <tr><td>DE</td><td>7.64%</td><td>5.87%</td><td>2.00%</td><td>5%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>EG</td><td>12.38%</td><td>12.35%</td><td>0.00%</td><td>5%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>GB</td><td>11.63%</td><td>8.93%</td><td>3.00%</td><td>5%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>IN</td><td>13.67%</td><td>8.67%</td><td>5.00%</td><td>5%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>JP</td><td>6.37%</td><td>9.79%</td><td>3.00%</td><td>5%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>MY</td><td>7.50%</td><td>10.51%</td><td>3.00%</td><td>5%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>PH</td><td>11.84%</td><td>9.90%</td><td>2.00%</td><td>5%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>PK</td><td>12.48%</td><td>9.28%</td><td>3.00%</td><td>5%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>SA</td><td>7.35%</td><td>12.35%</td><td>5.00%</td><td>5%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>TH</td><td>9.13%</td><td>12.35%</td><td>3.00%</td><td>5%</td><td class='status-ok'>✓ 达成</td></tr>
    </table>
    <h2>Adtype 预算分配检查</h2>
    <div class='summary'><strong>说明</strong>: 当 <code>allow_zero_budget=False</code> 时，检查每个推广区域下每个 Adtype 是否都分配了预算。按 (媒体, 平台, 广告类型) 聚合求和预算（跨所有 stage），只要预算 > 0 即视为已分配。</div>
    <div class='summary'><strong>总体满足率</strong>: 134/134 (100.0%)</div>
    <table>
      <tr><th>区域</th><th>满足数/总数</th><th>满足率</th></tr>
      <tr><td>DE</td><td>11/11</td><td>100.0%</td></tr>
      <tr><td>EG</td><td>14/14</td><td>100.0%</td></tr>
      <tr><td>GB</td><td>14/14</td><td>100.0%</td></tr>
      <tr><td>IN</td><td>11/11</td><td>100.0%</td></tr>
      <tr><td>JP</td><td>14/14</td><td>100.0%</td></tr>
      <tr><td>MY</td><td>14/14</td><td>100.0%</td></tr>
      <tr><td>PH</td><td>14/14</td><td>100.0%</td></tr>
      <tr><td>PK</td><td>14/14</td><td>100.0%</td></tr>
      <tr><td>SA</td><td>14/14</td><td>100.0%</td></tr>
      <tr><td>TH</td><td>14/14</td><td>100.0%</td></tr>
    </table>
    <div class='summary'><strong>✓ 所有 Adtype 都已分配预算</strong></div>
    <h2>区域 KPI满足情况</h2>
    <div class='summary'><strong>判断逻辑</strong>: 当"必须达成"为"是"时，要求实际值 ≥ 目标值；当"必须达成"为"否"时，满足达成率条件即可。</div>
    <h3>汇总</h3>
    <table>
      <tr><th>区域</th><th>达成数/总数</th><th>达成率</th></tr>
      <tr><td>DE</td><td>3/3</td><td>100.0%</td></tr>
      <tr><td>EG</td><td>3/3</td><td>100.0%</td></tr>
      <tr><td>GB</td><td>3/3</td><td>100.0%</td></tr>
      <tr><td>IN</td><td>3/3</td><td>100.0%</td></tr>
      <tr><td>JP</td><td>3/3</td><td>100.0%</td></tr>
      <tr><td>MY</td><td>3/3</td><td>100.0%</td></tr>
      <tr><td>PH</td><td>3/3</td><td>100.0%</td></tr>
      <tr><td>PK</td><td>3/3</td><td>100.0%</td></tr>
      <tr><td>SA</td><td>3/3</td><td>100.0%</td></tr>
      <tr><td>TH</td><td>3/3</td><td>100.0%</td></tr>
    </table>
    <h3>详细信息</h3>
    <h4>DE</h4>
    <table>
      <tr><th>KPI</th><th>优先级</th><th>必须达成</th><th>实际值</th><th>目标值</th><th>达成率</th><th>状态</th></tr>
      <tr><td>Engagement</td><td>1</td><td>是</td><td>18,571,700</td><td>14,321,134</td><td>130.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>VideoViews</td><td>2</td><td>否</td><td>96,985,552</td><td>77,590,302</td><td>125.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>Impression</td><td>3</td><td>否</td><td>174,574,000</td><td>134,045,820</td><td>130.00%</td><td class='status-ok'>✓ 达成</td></tr>
    </table>
    <h4>EG</h4>
    <table>
      <tr><th>KPI</th><th>优先级</th><th>必须达成</th><th>实际值</th><th>目标值</th><th>达成率</th><th>状态</th></tr>
      <tr><td>Engagement</td><td>1</td><td>是</td><td>36,489,869</td><td>28,949,496</td><td>126.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>VideoViews</td><td>2</td><td>否</td><td>148,811,079</td><td>119,051,167</td><td>125.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>Impression</td><td>3</td><td>是</td><td>349,708,592</td><td>349,723,137</td><td>100.00%</td><td class='status-ok'>✓ 达成</td></tr>
    </table>
    <h4>GB</h4>
    <table>
      <tr><th>KPI</th><th>优先级</th><th>必须达成</th><th>实际值</th><th>目标值</th><th>达成率</th><th>状态</th></tr>
      <tr><td>Engagement</td><td>1</td><td>否</td><td>28,270,210</td><td>21,799,767</td><td>130.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>VideoViews</td><td>2</td><td>否</td><td>147,633,330</td><td>118,108,696</td><td>125.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>Impression</td><td>3</td><td>是</td><td>265,740,000</td><td>204,045,820</td><td>130.00%</td><td class='status-ok'>✓ 达成</td></tr>
    </table>
    <h4>IN</h4>
    <table>
      <tr><th>KPI</th><th>优先级</th><th>必须达成</th><th>实际值</th><th>目标值</th><th>达成率</th><th>状态</th></tr>
      <tr><td>Engagement</td><td>1</td><td>否</td><td>171,914,989</td><td>69,384,802</td><td>248.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>VideoViews</td><td>2</td><td>是</td><td>146,854,008</td><td>90,933,918</td><td>161.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>Impression</td><td>3</td><td>是</td><td>1,099,548,889</td><td>1,098,926,766</td><td>100.00%</td><td class='status-ok'>✓ 达成</td></tr>
    </table>
    <h4>JP</h4>
    <table>
      <tr><th>KPI</th><th>优先级</th><th>必须达成</th><th>实际值</th><th>目标值</th><th>达成率</th><th>状态</th></tr>
      <tr><td>Engagement</td><td>1</td><td>是</td><td>14,152,931</td><td>11,784,093</td><td>120.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>VideoViews</td><td>2</td><td>否</td><td>72,494,637</td><td>50,708,148</td><td>143.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>Impression</td><td>3</td><td>是</td><td>99,118,057</td><td>99,116,369</td><td>100.00%</td><td class='status-ok'>✓ 达成</td></tr>
    </table>
    <h4>MY</h4>
    <table>
      <tr><th>KPI</th><th>优先级</th><th>必须达成</th><th>实际值</th><th>目标值</th><th>达成率</th><th>状态</th></tr>
      <tr><td>Engagement</td><td>1</td><td>否</td><td>16,784,339</td><td>13,427,858</td><td>125.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>VideoViews</td><td>2</td><td>否</td><td>84,572,769</td><td>56,074,422</td><td>151.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>Impression</td><td>3</td><td>是</td><td>252,941,193</td><td>138,482,400</td><td>183.00%</td><td class='status-ok'>✓ 达成</td></tr>
    </table>
    <h4>PH</h4>
    <table>
      <tr><th>KPI</th><th>优先级</th><th>必须达成</th><th>实际值</th><th>目标值</th><th>达成率</th><th>状态</th></tr>
      <tr><td>Engagement</td><td>1</td><td>否</td><td>69,849,791</td><td>32,652,820</td><td>214.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>VideoViews</td><td>2</td><td>否</td><td>99,273,276</td><td>79,420,448</td><td>125.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>Impression</td><td>3</td><td>是</td><td>337,016,850</td><td>242,435,140</td><td>139.00%</td><td class='status-ok'>✓ 达成</td></tr>
    </table>
    <h4>PK</h4>
    <table>
      <tr><th>KPI</th><th>优先级</th><th>必须达成</th><th>实际值</th><th>目标值</th><th>达成率</th><th>状态</th></tr>
      <tr><td>Engagement</td><td>1</td><td>是</td><td>31,675,449</td><td>31,676,916</td><td>100.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>VideoViews</td><td>2</td><td>是</td><td>438,034,557</td><td>151,210,601</td><td>290.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>Impression</td><td>3</td><td>否</td><td>583,858,806</td><td>467,109,466</td><td>125.00%</td><td class='status-ok'>✓ 达成</td></tr>
    </table>
    <h4>SA</h4>
    <table>
      <tr><th>KPI</th><th>优先级</th><th>必须达成</th><th>实际值</th><th>目标值</th><th>达成率</th><th>状态</th></tr>
      <tr><td>Engagement</td><td>1</td><td>是</td><td>16,312,929</td><td>15,973,664</td><td>102.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>VideoViews</td><td>2</td><td>是</td><td>80,577,589</td><td>54,316,965</td><td>148.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>Impression</td><td>3</td><td>否</td><td>248,693,424</td><td>191,639,731</td><td>130.00%</td><td class='status-ok'>✓ 达成</td></tr>
    </table>
    <h4>TH</h4>
    <table>
      <tr><th>KPI</th><th>优先级</th><th>必须达成</th><th>实际值</th><th>目标值</th><th>达成率</th><th>状态</th></tr>
      <tr><td>Engagement</td><td>1</td><td>是</td><td>24,673,342</td><td>24,674,090</td><td>100.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>VideoViews</td><td>2</td><td>否</td><td>89,538,000</td><td>71,631,775</td><td>125.00%</td><td class='status-ok'>✓ 达成</td></tr>
      <tr><td>Impression</td><td>3</td><td>是</td><td>264,495,727</td><td>193,084,917</td><td>137.00%</td><td class='status-ok'>✓ 达成</td></tr>
    </table>
    <h2>阶段预算满足情况</h2>
    <div class='summary'><strong>总体满足率</strong>: 10/10 (100.0%)</div>
    <table>
      <tr><th>区域</th><th>满足数/总数</th><th>满足率</th></tr>
      <tr><td>DE</td><td>1/1</td><td>100.0%</td></tr>
      <tr><td>EG</td><td>1/1</td><td>100.0%</td></tr>
      <tr><td>GB</td><td>1/1</td><td>100.0%</td></tr>
      <tr><td>IN</td><td>1/1</td><td>100.0%</td></tr>
      <tr><td>JP</td><td>1/1</td><td>100.0%</td></tr>
      <tr><td>MY</td><td>1/1</td><td>100.0%</td></tr>
      <tr><td>PH</td><td>1/1</td><td>100.0%</td></tr>
      <tr><td>PK</td><td>1/1</td><td>100.0%</td></tr>
      <tr><td>SA</td><td>1/1</td><td>100.0%</td></tr>
      <tr><td>TH</td><td>1/1</td><td>100.0%</td></tr>
    </table>
    <h2>营销漏斗预算满足情况</h2>
    <div class='summary'><strong>总体满足率</strong>: 17/30 (56.7%)</div>
    <table>
      <tr><th>区域</th><th>满足数/总数</th><th>满足率</th></tr>
      <tr><td>DE</td><td>0/3</td><td>0.0%</td></tr>
      <tr><td>EG</td><td>3/3</td><td>100.0%</td></tr>
      <tr><td>GB</td><td>0/3</td><td>0.0%</td></tr>
      <tr><td>IN</td><td>3/3</td><td>100.0%</td></tr>
      <tr><td>JP</td><td>3/3</td><td>100.0%</td></tr>
      <tr><td>MY</td><td>1/3</td><td>33.3%</td></tr>
      <tr><td>PH</td><td>2/3</td><td>66.7%</td></tr>
      <tr><td>PK</td><td>3/3</td><td>100.0%</td></tr>
      <tr><td>SA</td><td>1/3</td><td>33.3%</td></tr>
      <tr><td>TH</td><td>1/3</td><td>33.3%</td></tr>
    </table>
    <h2>媒体预算满足情况</h2>
    <div class='summary'><strong>总体满足率</strong>: 4/28 (14.3%)</div>
    <table>
      <tr><th>区域</th><th>满足数/总数</th><th>满足率</th></tr>
      <tr><td>DE</td><td>0/2</td><td>0.0%</td></tr>
      <tr><td>EG</td><td>2/3</td><td>66.7%</td></tr>
      <tr><td>GB</td><td>0/3</td><td>0.0%</td></tr>
      <tr><td>IN</td><td>0/2</td><td>0.0%</td></tr>
      <tr><td>JP</td><td>1/3</td><td>33.3%</td></tr>
      <tr><td>MY</td><td>0/3</td><td>0.0%</td></tr>
      <tr><td>PH</td><td>0/3</td><td>0.0%</td></tr>
      <tr><td>PK</td><td>1/3</td><td>33.3%</td></tr>
      <tr><td>SA</td><td>0/3</td><td>0.0%</td></tr>
      <tr><td>TH</td><td>0/3</td><td>0.0%</td></tr>
    </table>
    <h2>总体结论</h2>
    <h3>各维度达成情况汇总</h3>
    <table>
      <tr><th>维度</th><th>达成情况</th><th>达成率</th></tr>
      <tr><td>全局 KPI</td><td>3/3</td><td class='status-ok'>100.0%</td></tr>
      <tr><td>区域预算</td><td>10/10</td><td class='status-ok'>100.0%</td></tr>
      <tr><td>区域 KPI</td><td>30/30</td><td class='status-ok'>100.0%</td></tr>
      <tr><td>阶段预算</td><td>10/10</td><td class='status-ok'>100.0%</td></tr>
      <tr><td>营销漏斗预算</td><td>17/30</td><td class='status-fail'>56.7%</td></tr>
      <tr><td>媒体预算</td><td>4/28</td><td class='status-fail'>14.3%</td></tr>
      <tr><td>广告类型 KPI</td><td>100/312</td><td class='status-fail'>32.1%</td></tr>
      <tr><td>Adtype 预算分配</td><td>134/134</td><td class='status-ok'>100.0%</td></tr>
    </table>
  </div>
</body>
</html>
